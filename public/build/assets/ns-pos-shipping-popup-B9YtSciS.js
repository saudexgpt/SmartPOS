import{a as v}from"./bootstrap-DN_KIGH5.js";import{k as x,d as w,p as y}from"./print-DOU-TAfv.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o as n,c as l,b as t,t as u,F as h,e as b,n as m,g as f,w as k,j as S}from"./runtime-core.esm-bundler-DDZT2pc5.js";import"./chart-Ozef1QaY.js";import"./currency-gBUix5n2.js";const F={name:"ns-pos-shipping-popup",props:["popup"],computed:{activeTabFields(){if(this.tabs!==null){for(let s in this.tabs)if(this.tabs[s].active)return this.tabs[s].fields}return[]},useBillingInfo(){return this.tabs!==null?this.tabs.billing.fields[0].value:new Object},useShippingInfo(){return this.tabs!==null?this.tabs.shipping.fields[0].value:new Object}},unmounted(){this.orderSubscription.unsubscribe()},mounted(){this.orderSubscription=POS.order.subscribe(s=>this.order=s),this.popupCloser(),this.loadForm()},data(){return{tabs:null,orderSubscription:null,order:null,formValidation:new x}},watch:{useBillingInfo(s){s===1&&this.tabs.billing.fields.forEach(e=>{e.name!=="_use_customer_billing"&&(e.value=this.order.customer.billing?this.order.customer.billing[e.name]:e.value)})},useShippingInfo(s){s===1&&this.tabs.shipping.fields.forEach(e=>{e.name!=="_use_customer_shipping"&&(e.value=this.order.customer.shipping?this.order.customer.shipping[e.name]:e.value)})}},methods:{__,popupCloser:w,resolveIfQueued:y,submitInformations(){const s=this.formValidation.extractForm({tabs:this.tabs});for(let e in s.general)["shipping","shipping_rate"].includes(e)&&(s.general[e]=parseFloat(s.general[e]));this.order={...this.order,...s.general},delete s.general,delete s.shipping._use_customer_shipping,delete s.billing._use_customer_billing,this.order.addresses=s,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup(){this.resolveIfQueued(!1)},toggle(s){for(let e in this.tabs)this.tabs[e].active=!1;this.tabs[s].active=!0},loadForm(){v.get("/api/forms/ns.pos-addresses").subscribe(({tabs:s})=>{for(let e in s)e==="general"?s[e].fields.forEach(o=>{o.value=this.order[o.name]||""}):s[e].fields.forEach(o=>{o.value=this.order.addresses[e]?this.order.addresses[e][o.name]:""});this.tabs=this.formValidation.initializeTabs(s)})}}},V={class:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},I={class:"p-2 border-b ns-box-header flex justify-between items-center"},B={class:"font-bold text-primary"},P={class:"tools"},j={class:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},E={id:"tabs-container"},O={class:"header flex",style:{"margin-bottom":"-1px"}},T=["onClick"],N={class:"border ns-tab-item"},Q={class:"px-4"},z={class:"-mx-4 flex flex-wrap"},D={class:"p-2 flex justify-between border-t ns-box-footer"};function H(s,e,o,L,d,r){const _=c("ns-field"),g=c("ns-button");return n(),l("div",V,[t("div",I,[t("h3",B,u(r.__("Shipping & Billing")),1),t("div",P,[t("button",{onClick:e[0]||(e[0]=i=>r.closePopup()),class:"ns-close-button rounded-full h-8 w-8 border items-center justify-center"},e[2]||(e[2]=[t("i",{class:"las la-times"},null,-1)]))])]),t("div",j,[t("div",E,[t("div",O,[(n(!0),l(h,null,b(d.tabs,(i,a)=>(n(),l("div",{key:a,onClick:p=>r.toggle(a),class:m([i.active?"border-b-0 active":"inactive","tab rounded-tl rounded-tr border tab px-3 py-2 text-primary cursor-pointer"]),style:{"margin-right":"-1px"}},u(i.label),11,T))),128))]),t("div",N,[t("div",Q,[t("div",z,[(n(!0),l(h,null,b(r.activeTabFields,(i,a)=>(n(),l("div",{key:a,class:m("p-4 w-full md:w-1/2 lg:w-1/3")},[f(_,{onBlur:p=>d.formValidation.checkField(i),onChange:p=>d.formValidation.checkField(i),field:i},null,8,["onBlur","onChange","field"])]))),128))])])])])]),t("div",D,[e[3]||(e[3]=t("div",null,null,-1)),t("div",null,[f(g,{onClick:e[1]||(e[1]=i=>r.submitInformations()),type:"info"},{default:k(()=>[S(u(r.__("Save")),1)]),_:1})])])])}const M=C(F,[["render",H]]);export{M as default};
